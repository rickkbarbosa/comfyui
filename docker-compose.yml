version: "3.8"

services:
  comfy-ui-rocm:
    container_name: comfy-ui-rocm
    build:
      context: .
      dockerfile: Dockerfile
    image: rickkbarbosa/comfy-ui:rocm

    ports:
      - "8188:8188"

    volumes:
      - ./comfy/models:/app/ComfyUI/models
      - ./comfy/output:/app/ComfyUI/output
      - ./comfy/settings:/app/ComfyUI/settings
      - ./comfy/workflows:/app/ComfyUI/workflows

    # Necess√°rio para ROCm
    devices:
      - /dev/kfd
      - /dev/dri

    group_add:
      - video

    shm_size: "8gb"

    restart: unless-stopped
